#!/usr/bin/env python3

import os
import sys


project_dir = os.path.dirname(os.path.dirname(os.path.realpath(__file__)))
sys.path.insert(0, project_dir)

if not os.getenv("DATABASE_URL"):
    os.environ["DATABASE_URL"] = "sqlite:///%s" % os.path.join(project_dir, "dev.sqlite")

from app import app as application

from app.config import database_url
from app.models import BaseModel, db_engine

args = {
    "debug": True,
}

if len(sys.argv) > 1 and sys.argv[1] == "--public":
    args["host"] = "0.0.0.0"

if __name__ == "__main__":
    BaseModel.metadata.create_all(bind=db_engine)
    application.run(**args)
